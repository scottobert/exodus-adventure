var d=Object.defineProperty;var p=(e,t,n)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var a=(e,t,n)=>p(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();class f{constructor(t,n){a(this,"state");a(this,"scenes");this.scenes=Object.fromEntries(t.map(i=>[i.id,i])),this.state={scene:n,inventory:[],history:[]}}getCurrentScene(){return this.scenes[this.state.scene]}chooseOption(t){const n=this.getCurrentScene(),i=n.options[t];i.effect&&i.effect(this.state),this.state.history.push(n.id),this.state.scene=i.nextScene}getState(){return{...this.state}}}const h=[{id:"burning-bush",description:'You see a bush that burns but is not consumed. A voice calls your name: "Moses, Moses!"',options:[{text:"Approach the bush",nextScene:"god-speaks",effect:e=>{e.inventory.includes("faith")||e.inventory.push("faith")}},{text:"Run away",nextScene:"run-away"},{text:"Look for a staff nearby",nextScene:"find-staff",effect:e=>{e.inventory.includes("staff")||e.inventory.push("staff")}}]},{id:"find-staff",description:"You find a sturdy staff on the ground. It may be useful later.",options:[{text:"Return to the bush",nextScene:"god-speaks"}]},{id:"god-speaks",description:'God speaks to you from the bush: "Take off your sandals, for the place where you are standing is holy ground."',options:[{text:"Remove sandals and listen",nextScene:"mission",effect:e=>{e.inventory.includes("obedience")||e.inventory.push("obedience")}}]},{id:"run-away",description:"You run away, but the memory of the burning bush stays with you.",options:[{text:"Return to the bush",nextScene:"burning-bush"}]},{id:"mission",description:'God gives you a mission: "Go to Pharaoh and bring my people out of Egypt."',options:[{text:"Accept the mission",nextScene:"accepted",effect:e=>{e.inventory.includes("trust")||e.inventory.push("trust")}},{text:"Refuse",nextScene:"refused"}]},{id:"accepted",description:"You accept God’s mission. Your journey begins! You travel to Egypt to confront Pharaoh.",options:[{text:"Go to Pharaoh’s palace",nextScene:"pharaoh-palace"}]},{id:"refused",description:"You refuse, but God encourages you to trust Him.",options:[{text:"Accept the mission",nextScene:"accepted"}]},{id:"pharaoh-palace",description:'You stand before Pharaoh. He looks at you with suspicion. "Let my people go," you declare.',options:[{text:"Demand release",nextScene:"pharaoh-refuses"},{text:"Show a sign",nextScene:"staff-to-snake",effect:e=>{e.inventory.includes("staff")||e.inventory.push("borrowed staff")}},{text:"Offer a gift",nextScene:"pharaoh-softens"}]},{id:"pharaoh-softens",description:"Pharaoh is surprised by your gift. He seems less hostile, but still refuses to let the people go.",options:[{text:"Warn of plagues",nextScene:"plagues-begin"},{text:"Try to negotiate",nextScene:"negotiation"}]},{id:"negotiation",description:"You attempt to negotiate with Pharaoh. He offers to let only some people go.",options:[{text:"Accept partial freedom",nextScene:"partial-freedom"},{text:"Insist on full freedom",nextScene:"pharaoh-refuses"}]},{id:"partial-freedom",description:"Some Israelites are freed, but many remain. The story ends with hope for the rest.",options:[]},{id:"pharaoh-refuses",description:"Pharaoh refuses to let the Israelites go. God tells you to warn him of plagues.",options:[{text:"Warn of plagues",nextScene:"plagues-begin"}]},{id:"staff-to-snake",description:"You throw your staff down and it becomes a snake! Pharaoh’s magicians do the same. Pharaoh is unimpressed.",options:[{text:"Warn of plagues",nextScene:"plagues-begin",effect:e=>{e.inventory.includes("perseverance")||e.inventory.push("perseverance")}}]},{id:"plagues-begin",description:"The plagues begin: water turns to blood, frogs, gnats, and more. Pharaoh’s heart remains hard.",options:[{text:"Continue with more plagues",nextScene:"final-plague"}]},{id:"final-plague",description:"The final plague strikes: the death of the firstborn. Pharaoh finally lets the Israelites go.",options:[{text:"Lead the people out",nextScene:"red-sea"}]},{id:"red-sea",description:"You reach the Red Sea. Pharaoh’s army is pursuing you! The people panic.",options:[{text:"Raise your staff",nextScene:"sea-parts",effect:e=>{e.inventory.includes("staff")||e.inventory.push("miraculous staff"),e.inventory.includes("deliverance")||e.inventory.push("deliverance")}},{text:"Pray for help",nextScene:"sea-parts",effect:e=>{e.inventory.includes("deliverance")||e.inventory.push("deliverance")}},{text:"Look for another way around",nextScene:"lost-in-desert"}]},{id:"lost-in-desert",description:"You try to find another way, but get lost in the desert. The journey is much harder.",options:[{text:"Return to the sea",nextScene:"red-sea"}]},{id:"mount-sinai",description:"At Mount Sinai, God gives you the Ten Commandments. The people begin a new life as a free nation.",options:[{text:"Reflect on the journey",nextScene:"end",effect:e=>{e.inventory.includes("wisdom")||e.inventory.push("wisdom")}},{text:"Check your inventory",nextScene:"show-inventory"}]},{id:"show-inventory",description:"You check your belongings: ",options:[{text:"Continue",nextScene:"end"}]},{id:"end",description:"You have led your people out of Egypt and received God’s law. The adventure continues in the wilderness...",options:[]}],c=new f(h,"burning-bush");function u(){const e=c.getCurrentScene(),t=document.querySelector("#app");if(!t)return;const n=c.getState();let i="";n.inventory.length>0&&(i=`<div style="margin-bottom:1em;"><strong>Inventory:</strong> ${n.inventory.join(", ")}</div>`),e.id==="show-inventory"&&(i=`<div style="margin-bottom:1em;"><strong>Inventory:</strong> ${n.inventory.length?n.inventory.join(", "):"Nothing"}</div>`),t.innerHTML=`
    <div class="game-container">
      <div class="scene-description">${e.description}${i}</div>
      <div class="options">
        ${(e.options||[]).map((s,r)=>`<button data-index="${r}">${s.text}</button>`).join("")}
      </div>
    </div>
  `,t.querySelectorAll(".options button").forEach(s=>{s.addEventListener("click",()=>{c.chooseOption(parseInt(s.getAttribute("data-index")||"0",10)),u()})})}u();
