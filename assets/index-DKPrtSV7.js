var f=Object.defineProperty;var y=(e,t,n)=>t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var u=(e,t,n)=>y(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();class g{constructor(t,n){u(this,"state");u(this,"scenes");this.scenes=Object.fromEntries(t.map(s=>[s.id,s])),this.state={scene:n,inventory:{},history:[]}}getCurrentScene(){return this.scenes[this.state.scene]}chooseOption(t){const n=this.getCurrentScene(),s=n.options[t];s.effect&&s.effect(this.state),this.state.history.push(n.id),this.state.scene=s.nextScene}getState(){return{...this.state}}}function d(e,t,n=1){e.inventory[t]||(e.inventory[t]=0),e.inventory[t]+=n}const x=[{id:"burning-bush",description:'You see a bush that burns but is not consumed. A voice calls your name: "Moses, Moses!"',options:[{text:"Approach the bush",nextScene:"god-speaks",effect:e=>{d(e,"faith")}},{text:"Run away",nextScene:"run-away"},{text:"Look for a staff nearby",nextScene:"find-staff",effect:e=>{d(e,"staff")}}]},{id:"find-staff",description:"You find a sturdy staff on the ground. It may be useful later.",options:[{text:"Return to the bush",nextScene:"god-speaks"}]},{id:"god-speaks",description:'God speaks to you from the bush: "Take off your sandals, for the place where you are standing is holy ground."',options:[{text:"Remove sandals and listen",nextScene:"mission",effect:e=>{d(e,"obedience")}}]},{id:"run-away",description:"You run away, but the memory of the burning bush stays with you.",options:[{text:"Return to the bush",nextScene:"burning-bush"}]},{id:"mission",description:'God gives you a mission: "Go to Pharaoh and bring my people out of Egypt."',options:[{text:"Accept the mission",nextScene:"accepted",effect:e=>{d(e,"trust")}},{text:"Refuse",nextScene:"refused"}]},{id:"accepted",description:"You accept God’s mission. Your journey begins! You travel to Egypt to confront Pharaoh.",options:[{text:"Go to Pharaoh’s palace",nextScene:"pharaoh-palace"}]},{id:"refused",description:"You refuse, but God encourages you to trust Him.",options:[{text:"Accept the mission",nextScene:"accepted"}]},{id:"pharaoh-palace",description:'You stand before Pharaoh. He looks at you with suspicion. "Let my people go," you declare.',options:[{text:"Demand release",nextScene:"pharaoh-refuses"},{text:"Show a sign",nextScene:"staff-to-snake",effect:e=>{d(e,"borrowed staff")}},{text:"Offer a gift",nextScene:"pharaoh-softens"}]},{id:"pharaoh-softens",description:"Pharaoh is surprised by your gift. He seems less hostile, but still refuses to let the people go.",options:[{text:"Warn of plagues",nextScene:"plagues-begin"},{text:"Try to negotiate",nextScene:"negotiation"}]},{id:"negotiation",description:"You attempt to negotiate with Pharaoh. He offers to let only some people go.",options:[{text:"Accept partial freedom",nextScene:"partial-freedom"},{text:"Insist on full freedom",nextScene:"pharaoh-refuses"}]},{id:"partial-freedom",description:"Some Israelites are freed, but many remain. The story ends with hope for the rest.",options:[]},{id:"pharaoh-refuses",description:"Pharaoh refuses to let the Israelites go. God tells you to warn him of plagues.",options:[{text:"Warn of plagues",nextScene:"plagues-begin"}]},{id:"staff-to-snake",description:"You throw your staff down and it becomes a snake! Pharaoh’s magicians do the same. Pharaoh is unimpressed.",options:[{text:"Warn of plagues",nextScene:"plagues-begin",effect:e=>{d(e,"perseverance")}}]},{id:"plagues-begin",description:"The plagues begin: water turns to blood, frogs, gnats, and more. Pharaoh’s heart remains hard.",options:[{text:"Continue with more plagues",nextScene:"final-plague"}]},{id:"final-plague",description:"The final plague strikes: the death of the firstborn. Pharaoh finally lets the Israelites go.",options:[{text:"Lead the people out",nextScene:"red-sea"}]},{id:"red-sea",description:"You reach the Red Sea. Pharaoh’s army is pursuing you! The people panic.",options:[{text:"Raise your staff",nextScene:"sea-parts",effect:e=>{d(e,"miraculous staff"),d(e,"deliverance")}},{text:"Pray for help",nextScene:"sea-parts",effect:e=>{d(e,"deliverance")}},{text:"Look for another way around",nextScene:"lost-in-desert"}]},{id:"lost-in-desert",description:"You try to find another way, but get lost in the desert. The journey is much harder.",options:[{text:"Return to the sea",nextScene:"red-sea"}]},{id:"sea-parts",description:"The sea miraculously parts! Do you lead the people through?",options:[{text:"Go back to the safety of Egypt and rule under Pharaoh.",nextScene:"partial-freedom"},{text:"Lead the people through the sea",nextScene:"crossing-red-sea"}]},{id:"crossing-red-sea",description:"You lead the people through the dry seabed. The waters close behind you, drowning Pharaoh’s army.",options:[{text:"Celebrate the deliverance",nextScene:"mount-sinai",effect:e=>{d(e,"deliverance")}},{text:"Check your inventory",nextScene:"show-inventory"}]},{id:"mount-sinai",description:"At Mount Sinai, God gives you the Ten Commandments. The people begin a new life as a free nation.",options:[{text:"Reflect on the journey",nextScene:"end",effect:e=>{d(e,"wisdom")}},{text:"Check your inventory",nextScene:"show-inventory"}]},{id:"show-inventory",description:"You check your belongings: ",options:[{text:"Continue",nextScene:"end"}]},{id:"end",description:"You have led your people out of Egypt and received God’s law. The adventure continues in the wilderness...",options:[]}],l=new g(x,"burning-bush");function h(){const e=l.getCurrentScene(),t=document.querySelector("#app");if(!t)return;const n=l.getState();let s="";const o=Object.entries(n.inventory);o.length>0?s=`
      <div class="header-inventory-dropdown">
        <button class="inventory-dropdown-toggle" aria-haspopup="listbox" aria-expanded="false">Inventory (${o.length}) ▼</button>
        <div class="inventory-dropdown-list" style="display:none;">
          ${o.map(([a,p])=>`
            <div class="inventory-box"><span class="inventory-item">${a}</span><span class="inventory-count">${p}</span></div>
          `).join("")}
        </div>
      </div>
    `:s='<div class="header-inventory-list">Nothing</div>';const i=`
    <header class="game-header">
      <span class="header-title">Exodus Adventure</span>
      ${s}
    </header>
  `;t.innerHTML=`
    ${i}
    <div class="game-container">
      <div class="scene-description">${e.description}</div>
      <div class="options">
        ${(e.options||[]).map((a,p)=>`<button data-index="${p}">${a.text}</button>`).join("")}
      </div>
    </div>
  `;const r=t.querySelector(".inventory-dropdown-toggle"),c=t.querySelector(".inventory-dropdown-list");r&&c&&(c.style.display="none",r.setAttribute("aria-expanded","false"),r.addEventListener("click",a=>{a.stopPropagation(),c.style.display==="none"?(c.style.display="flex",r.setAttribute("aria-expanded","true")):(c.style.display="none",r.setAttribute("aria-expanded","false"))}),document.addEventListener("click",a=>{!r.contains(a.target)&&!c.contains(a.target)&&(c.style.display="none",r.setAttribute("aria-expanded","false"))},!0)),t.querySelectorAll(".options button").forEach(a=>{a.addEventListener("click",()=>{l.chooseOption(parseInt(a.getAttribute("data-index")||"0",10)),h()})})}h();
